#!/bin/dash
if [ ! "$1" ]; then
    list="$(mpc listall | dmenu)"
    [ "$list" ] && $0 $list
    exit 0
fi

list="$(mpc listall)"
for arg in $@; do
    list="$(echo "$list" | grep "$arg")"
done

[ "$list" ] || exit 0

[ "$(mpc status | grep "\[playing\]")" ] || mpc clear

echo "$list" | mpc add
[ 0 = "$?" ] && mpc play && mpc playlist -f '%position% [[%title%[ - %album%][ (%artist%)]]|[%file%]]' || $0 $list

exit 0

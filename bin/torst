#!/bin/bash
q="$*"
q=${q// /+}
magnets="$(curl -s "https://thepiratebay.org/search/$q" | grep -Pom10 '(?<= href=")magnet:[^"]*(?=")')"
echo "$magnets" | grep -Po '(?<=&dn=)[^&]*' | nl
read -p '> ' q
[ q = "$q" ] && exit 1
magnet="$(echo "$magnets" | head -n $q | tail -n 1)"
TMPDIR=$HOME/torrents nodejs ~/src/peerflix/app.js --mpv -n "$magnet" -- --volume-max=1000
exit 0
